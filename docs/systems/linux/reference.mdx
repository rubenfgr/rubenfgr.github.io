---
title: "Referencia"
---

## Información del sistema

```sh
lsb_release --help
uname --help
```

- **mostrará la arquitectura de tu ordenador.**

  ```sh
  arch
  dpkg --print-architecture
  uname -a
  ```

- **CPU Información**

  ```sh
  cat /proc/cpuinfo
  grep "model name" /proc/cpuinfo
  ```

- **Número de CPUS**

  ```sh
  grep "model name" /proc/cpuinfo | wc -l
  ```

- **mostrará la versión del kernel que está usado.**

  ```sh
  uname -r
  ```

- **mostrará los componentes de hardware presentes en el sistema.**

  ```sh
  dmidecode -q
  ```

- **mostrará las características del disco duro que le indiques.**

  ```sh
  hdparm -i /dev/hda
  ```

- **mostrará la información sobre la CPU.**

  ```sh
  cat /proc/cpuinfo
  ```

- **verificará el uso de memoria RAM.**

  ```sh
  cat /proc/meminfo
  ```

- **muestra el estado y uso de la memoria RAM.**

  ```sh
  free -m
  ```

- **mostrará los adaptadores de red y sus estadísticas.**

  ```sh
  cat /proc/net/dev
  ```

- **mostrará el sistema de archivos montado.**

  ```sh
  cat /proc/mounts
  ```

- **mostrará los dispositivos PCI presentes.**

  ```sh
  lspci -tv
  ```

- **mostrará los dispositivos USB conectados.**

  ```sh
  lsusb -tv
  ```

- **Listar procesos**

  ```sh
  top
  htop # mejor visual y más opciones
  ```

- **Fechas y calendario**

  ```sh
  date
  cal 2018
  cal 05 2018
  ```

- **Mostrar manual**

  ```sh
  man ping
  ```

## Parámetros del sistema

- Aumentar el número de tareas del usuario

  1. Comentar y modificar

     ```sh
     /etc/systemd/logind.conf UserTasksMax
     ```

  2. Ejecutar

     ```sh
     sudo systemctl daemon-reload
     sudo systemctl dademon-reexec
     sudo service systemd-logind restart
     # Opcional
     # sudo service <service-name> restart
     ```

## Apagar y reiniciar

- **Apagar**

  ```sh
  # reiniciará tu equipo inmediatamente
  sudo shutdown -r now
  # Reiniciar después de un tiempo determinado
  sudo shutdown -r +<tiempo-deseado-en-minutos>
  sudo shutdown -h +<tiempo-deseado-en-minutos>
  # Reiniciar a una hora determinada
  sudo shutdown -h <hora-deseada-(0-23)>
  # cancelar un apagado planificado del sistema
  sudo shutdown -c
  ```

- **Reiniciar**

  ```sh
  reboot
  # mostrará un historial de cuando se realizaron los últimos reinicios.
  last reboot
  ```

- **Cerrar sesión**

  ```sh
  logout
  ```

## Movimiento

- **Te llevará directamente hasta la ruta que indiques, en este caso hasta el directorio “usuario”.**

  ```sh
  cd /home/usuario
  ```

- **retrocederás un nivel en la jerarquía de directorios.**

  ```sh
  cd ..
  ```

- **retrocederás 2 niveles en la jerarquía de directorios.**

  ```sh
  cd ../..
  ```

- **te llevará al directorio raíz de esa unidad.**

  ```sh
  cd
  ```

- **irás al directorio principal del usuario que indiques.**

  ```sh
  cd ~usuario
  ```

- **regresarás al directorio anterior.**

  ```sh
  cd –
  ```

## Listado

- **mostrará la ruta del directorio donde te encuentras actualmente.**

  ```sh
  pwd
  ```

- **mostrará los archivos y carpetas del directorio donde te encuentras.**

  ```sh
  ls
  ```

- **mostrara los detalles de archivos y carpetas del directorio actual.**

  ```sh
  ls -l
  ```

- **mostrará los archivos ocultos del directorio actual**

  ```sh
  ls -a
  ```

## Variables de entorno

- **Modificar las variables de entorno en todos los perfiles**

  Editar el archivo /etc/bash.bashrc y añadir al final..., por ejemplo, para Java:

  ```sh
  export JAVA_HOME=/usr/lib/jvm/<home-java-version>
  export PATH=$PATH:$JAVA_HOME
  ```

- **Refrescar los cambios sin salir del terminal**

  ```sh
  source /etc/bash.bashrc
  ```

- **Modificar las variables de entorno en todos los perfiles**

  Editar el archivo /etc/bash.bashrc y añadir al final..., por ejemplo, para Java:

  ```sh
  export JAVA_HOME=/usr/lib/jvm/<home-java-version>
  export PATH=$PATH:$JAVA_HOME
  ```

## Archivos y directorios

### Crear, borrar, copiar y enlaces

- **creará una nueva carpeta o directorio con nombre que le indiques. En este caso, “Directorio”.**

  ```sh
  mkdir Directorio
  ```

- **creará dos carpetas simultáneamente.**

  ```sh
  mkdir Directorio1 Directorio 2
  ```

- **borrará la carpeta llamada “Directorio”.**

  ```sh
  rmdir Directorio
  ```

- **eliminará una carpeta llamada “Directorio” y todo su contenido.**

  ```sh
  rm -rf Directorio
  ```

- **renombrará o moverá un archivo o carpeta.**

  ```sh
  mv Viejodirectorio Nuevodirectorio
  ```

- **copiará un archivo.**

  ```sh
  cp Archivo
  ```

- **copiará dos archivos simultáneamente.**

  ```sh
  cp Archivo1 Archivo2
  ```

- **copiará una carpeta completa, en este caso “Directorio”.**

  ```sh
  cp -a Directorio
  ```

- **copiará dos directorios simultáneamente.**

  ```sh
  cp -a Directorio1 Directorio2
  ```

- **creará un enlace simbólico con un determinado nombre, al archivo o directorio indicado.**

  ```sh
  ln -s Archivo Enlacearchivo
  ```

- **creará un enlace físico con el nombre indicado al archivo o directorio indicado**

  ```sh
  ln Archivo Enlacearchivo
  ```

### Búsquedas

- **buscará ese archivo o directorio comenzado por la raíz del sistema.**

  ```sh
  find / -name Archivo
  ```

- **buscará archivos y directorios propiedad del usuario “Usuario”.**

  ```sh
  find / -user Usuario
  ```

- **buscará todos los archivos con la extensión que le indiques, en este caso “. bin”, dentro del directorio indicado, que en el ejemplo es “/ home/usuario”.**

  ```sh
  find /home/usuario -name \*.bin
  ```

- **buscará los archivos creados o cambiados en el sistema dentro de los últimos “5” días.**

  ```sh
  find /usr/bin -type f -mtime -5
  ```

- **mostrará la ubicación de un archivo binario, de ayuda o fuente. En este caso pregunta dónde está “Firefox”.**

  ```sh
  Whereis firefox
  ```

- **mostrará la ruta completa al binario/ejecutable que le indiques**

  ```sh
  Which firefox
  ```

- **Buscar en todos los archivos de un directorio y sus subdirectorios**

  ```sh
  grep -i -R listen *
  ```

## Grupos, usuarios y permisos

### Permisos

Fuente --> [https://blog.desdelinux.net/permisos-y-derechos-en-linux/](https://blog.desdelinux.net/permisos-y-derechos-en-linux/)

- **Primer carácter de los archivos**

  | Permiso | Identifica                                                         |
  | ------- | ------------------------------------------------------------------ |
  | -       | Archivo                                                            |
  | d       | Directorio                                                         |
  | b       | Archivo de bloques especiales (Archivos especiales de dispositivo) |
  | c       | Archivo de caracteres especiales (Dispositivo tty, impresora...)   |
  | l       | Archivo de vinculo o enlace (soft/symbolic link)                   |
  | p       | Archivo especial de cauce (pipe o tubería)                         |

- **Caracteres que definen los permisos**

  | Permiso | Identifica  |
  | ------- | ----------- |
  | -       | Sin permiso |
  | r       | Lectura     |
  | w       | Escritura   |
  | x       | Ejecución   |

- **Estructura de permisos de archivos o directorios**

  > Ejemplo: -rw-r--r-- ... archivo.pdf

  | Tipo               | Usuario              | Grupo                | Resto de usuarios (otros) | Nombre del archivo           |
  | ------------------ | -------------------- | -------------------- | ------------------------- | ---------------------------- |
  | <center>-</center> | <center>rw-</center> | <center>r--</center> | <center>r--</center>      | <center>archivo.pdf</center> |

- **Asignación de permisos**

  | Parámetro | Nivel | Descripción                                    |
  | --------- | ----- | ---------------------------------------------- |
  | u         | dueño | dueño del archivo o directorio                 |
  | g         | grupo | Grupo al que pertenece el archivo o directorio |
  | o         | otros | Demás usuarios que no son dueño ni grupo       |

- **Ejemplos de permisos**

  ```sh
  # Dar permiso de ejecución al dueño:
  chmod u+x komodo.sh
  # Quitar permiso de ejecución a todos los usuarios:
  chmod -x komodo.sh
  # Dar permiso de lectura y escritura a los demás usuarios:
  chmod o+r+w komodo.sh
  # Dejar solo permiso de lectura al grupo al que pertenece el archivo:
  chmod g+r-w-x komodo.sh
  ```

- **Permisos en formato númerico octal**

  `r = 4, w = 2, x = 1`

  | Permiso              | Valor Octal        | Descripción                                                     |
  | -------------------- | ------------------ | --------------------------------------------------------------- |
  | <center>---</center> | <center>0</center> | no se tiene ningún permiso                                      |
  | <center>--x</center> | <center>1</center> | solo permiso de ejecución                                       |
  | <center>-w-</center> | <center>2</center> | solo permiso de escritura                                       |
  | <center>-wx</center> | <center>3</center> | permisos de escritura y ejecución                               |
  | <center>r--</center> | <center>4</center> | solo permiso de lectura                                         |
  | <center>r-x</center> | <center>5</center> | permisos de lectura y ejecución                                 |
  | <center>rw-</center> | <center>6</center> | permisos de lectura y escritura                                 |
  | <center>rwx</center> | <center>7</center> | todos los permisos establecidos, lectura, escritura y ejecución |

- **Ejemplos de permisos con octal**

  | Permiso                      | Valor                | Descripción                                                                        |
  | ---------------------------- | -------------------- | ---------------------------------------------------------------------------------- |
  | <center>rw- --- ---</center> | <center>600</center> | Propietario = lectura y escritura                                                  |
  | <center>rwx --x --x</center> | <center>711</center> | Propietario = lectura, escritura y ejecución, Grupo y otros = ejecución            |
  | <center>rwx r-x r-x</center> | <center>755</center> | Propietario = lectura, escritura y ejecución, Grupos y otros = lectura y ejecución |
  | <center>rwx rwx rwx</center> | <center>777</center> | Todos = lectura, escritura y ejecución                                             |
  | <center>r-- --- ---</center> | <center>400</center> | Propietario = lectura                                                              |
  | <center>rw- r-- ---</center> | <center>640</center> | Propietario = lectura y escritura, Grupo = lectura                                 |

- **Mostrará los permisos de un archivo.**

  ```sh
  ls -lh
  ```

- **cambiará el propietario de un determinado archivo.**

  ```sh
  chown Usuario1 Archivo1
  ```

- **cambiará el propietario de un determinado directorio y de todos los archivos y subdirectorios contenidos dentro.**

  ```sh
  chown -R Usuario1 directory1
  ```

- **convierte el archivo en invariable, por lo que no puede ser eliminado, alterado, renombrado, ni enlazado.**

  ```sh
  chattr +i Archivo1
  ```

- **permite que un archivo sea borrado de forma segura.**

  ```sh
  chattr +s Archivo1
  ```

- **mostrará los atributos especiales.**

  ```sh
  lsattr
  ```

### Usuarios y grupos

- **quien eres tú**

  ```sh
  whoami
  ```

- **mostrará los usuarios presentes en el equipo.**

  ```sh
  cat /etc/passwd
  cat /etc/shadow
  ```

- **mostrará los grupos presentes en el equipo**

  ```sh
  cat /etc/group
  ```

- **crear un nuevo grupo en el sistema.**

  ```sh
  groupadd nombre_del_grupo
  ```

- **borrará un grupo ya existente en el sistema.**

  ```sh
  groupdel nombre_del_grupo
  ```

- **renombrará un grupo ya existente.**

  ```sh
  groupmod -n nuevo_grupo viejo_grupo
  ```

- **Mostrar grupos de usuario**

  ```sh
  groups <usuario>
  ```

- **Creará un nuevo usuario perteneciente al grupo “admin”.**

  ```sh
  useradd -c “Nombre usuario” -g admin -d /home/nuevousuario -s /bin/bashnuevousuario
  ```

- **Agregar al usuario actual al grupo**

  ```sh
  usermod -aG docker $USER
  ```

- **Activar cambios en los grupos**

  ```sh
  newgrp docker
  ```

- **creará un nuevo usuario.**

  ```sh
  useradd Usuario1
  ```

- **borrará un usuario y su directorio Home.**

  ```sh
  userdel -r Usuario1
  ```

- **cambiará tu contraseña de usuario.**

  ```sh
  passwd
  ```

- **cambiará la contraseña del usuario indicado (solo permitido para el usuario root).**

  ```sh
  passwd Usuario1
  ```

- **establece una caducidad para la contraseña de un usuario determinado. En este caso expira el 31 de diciembre de 2019.**

  ```sh
  chage -E 2019-12-31 Usuario1
  ```

### Alias

- **Para crear alias privados al usuaro se ha de modificar el archivo**

  ```sh
  sudo nano /home/<usuario>/.bashrc
  ```

- **Ejemplo para crear un alias**

  ```sh
  alias java8='source /home/rubenfgr/Scripts/java8.sh'
  ```

### Sudoers

- **Agregar usuario al grupo sudoers**

  ```sh
  sudo nano /etc/sudoers
  # Agregar al final la siguiente linea y guardar
  <nombre-usuario> ALL=(ALL:ALL) ALL
  ```

  ```sh
  sudo usermod -aG sudo <nombre-usuario>
  ```

## Repositorios y Paquetes

- **Directorio de los repositorios**

  ```sh
  cd /etc/apt/
  # Fichero de los repos oficiales
  cd /etc/apt/sources.list
  ```

### .DEB

Debian, Ubuntu, Mint y distribuciones derivadas.

- **instalará o actualizará un paquete deb.**

  ```sh
  dpkg -i paquete.deb
  ```

- **eliminará un determinado paquete deb del sistema.**

  ```sh
  dpkg -r paquete
  ```

- **mostrará todos los paquetes deb instalados en el sistema.**

  ```sh
  dpkg -l
  ```

- **mostrará información del paquete indicado instalado en el sistema.**

  ```sh
  dpkg -s paquete
  ```

### Gestor de paquetes APT

- **Agregar claves públicas de servidores al APT**

  ```sh
  sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys KEYS_HERE
  ```

- **instalará o actualizará un determinado paquete deb.**

  ```sh
  apt-get install paquete
  ```

- **instalará o actualizará un paquete deb desde un cdrom.**

  ```sh
  apt-cdrom install paquete
  ```

- **actualizará la lista de paquetes instalados.**

  ```sh
  apt-get update
  ```

- **actualizará todos los paquetes instalados.**

  ```sh
  apt-get upgrade
  ```

- **eliminará el paquete deb indicado del sistema.**

  ```sh
  apt-get remove paquete
  ```

- **verificará la correcta resolución de las dependencias.**

  ```sh
  apt-get check
  ```

- **limpiará la cache desde los paquetes descargados.**

  ```sh
  apt-get clean
  ```

- **Buscar un paquete**

  ```sh
  apt-cache show <paquete>
  ```

### .RPM

Red Hat, Fedora, SUSE Linux,etc.

- **instalará un paquete rpm.**

  ```sh
  rpm -ivh paquete.rpm
  ```

- **instalará un paquete rpm ignorando las peticiones de dependencias.**

  ```sh
  rpm -ivh –nodeeps paquete.rpm
  ```

- **actualizará un paquete rpm sin cambiar la configuración de los ficheros.**

  ```sh
  rpm -U paquete.rpm
  ```

- **actualizará un determinado paquete rpm solamente si este está instalado.**

  ```sh
  rpm -F paquete.rpm
  ```

- **eliminará el paquete rpm indicado.**

  ```sh
  rpm -e paquete.rpm
  ```

- **mostrará todos los paquetes rpm instalados en el sistema.**

  ```sh
  rpm -qa
  ```

- **ofrece la información en un paquete específico instalado.**

  ```sh
  rpm -qi paquete
  ```

- **mostrará el historial de revisiones de un paquete rpm.**

  ```sh
  rpm -q paquete –changelog
  ```

- **verificará la integridad de un paquete rpm.**

  ```sh
  rpm –checksig paquete.rpm
  ```

- **verificará la integridad de todos los paquetes rpm instalados**

  ```sh
  rpm -qa gpg-pubkey
  ```

### Gestor de paquetes YUM

Red Hat, Fedora y similares

- **descargará e instalará un determinado paquete rpm.**

  ```sh
  yum install paquete
  ```

- **instalará un paquete rpm y tratará de resolver todas las dependencias usando tus repositorios.**

  ```sh
  yum localinstall paquete.rpm
  ```

- **actualizará todos los paquetes rpm instalados en el sistema.**

  ```sh
  yum update paquete.rpm
  ```

- **actualizará un determinado paquete rpm.**

  ```sh
  yum update paquete
  ```

- **eliminará el paquete rpm especificado.**

  ```sh
  yum remove paquete
  ```

- **listará todos los paquetes de software instalados en el sistema.**

  ```sh
  yum list
  ```

- **encontrará un paquete en repositorio rpm.**

  ```sh
  yum search paquete
  ```

## Redes

- **Comprobar que un servicio en segun plano (daemon) esta escuchando**

  ```sh
  netstat -lntp | grep <nombre-servicio>
  ```

- **Comprobar puertos a las escucha**

  ```sh
  # Todos
  ss -lntp
  # Uno en concreto
  ss -lntp | grep 1080
  # netstat
  netstat -putane | grep <filtro>
  sudo lsof -i:80
  sudo fuser -k 80/tcp
  ```

### IPTABLES

- **Redireccionar puerto a IP + PUERTO de destino**

  ```sh
  sudo iptables -t nat -A PREROUTING -i eth1 -p tcp --dport 80 -j DNAT --to-destination 192.168.2.80
  ```

- **Persistir la configuración**

  ```sh
  # Instalar iptables-persistant
  sudo apt install iptables-persistant
  # Guardar la configuración
  sudo iptables-save
  ```

### Resolutores de host DNS e IP

```sh
dig blog.rubenfgr.com # De DNS a IP
dig -x blog.rubenfgr.com # De IP a DNS
host blog.rubenfgr.com # Indistinto
nslookup blog.rubenfgr.com # Indistinto
```

### Reiniciar cache DNS

```sh
# Cliente
/etc/init.d/nscd restart
# Servidor
/usr/sbin/rndc flush
```
